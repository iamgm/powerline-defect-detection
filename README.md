# ‚ö° Power Line Defect Detection

![Python](https://img.shields.io/badge/Python-3.11-blue)
![YOLO](https://img.shields.io/badge/YOLO-OBB-green)
![FastAPI](https://img.shields.io/badge/FastAPI-Backend-009688)
![Streamlit](https://img.shields.io/badge/Streamlit-Frontend-FF4B4B)
![Docker](https://img.shields.io/badge/Docker-Ready-2496ED)

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏–∏ –ª–∏–Ω–∏–π —ç–ª–µ–∫—Ç—Ä–æ–ø–µ—Ä–µ–¥–∞—á (–õ–≠–ü) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è. –ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–Ω–∏–º–∫–∞—Ö —Å –ë–ü–õ–ê, –∏—Å–ø–æ–ª—å–∑—É—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ bounding box'—ã (OBB) –¥–ª—è –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏.

### üîó [–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã (Hugging Face Space)](URL)

---

## üìñ –û –ø—Ä–æ–µ–∫—Ç–µ

–í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω—Å–ø–µ–∫—Ü–∏—è –õ–≠–ü - —Ç—Ä—É–¥–æ–µ–º–∫–∏–π –∏ –æ–ø–∞—Å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –∞–Ω–∞–ª–∏–∑ —Å–Ω–∏–º–∫–æ–≤, –ø–æ–∑–≤–æ–ª—è—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

* **OBB (Oriented Bounding Boxes):** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–∫–ª–æ–Ω–Ω—ã—Ö —Ä–∞–º–æ–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ—á–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ –∏ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (–≥–∏—Ä–ª—è–Ω–¥—ã –∏–∑–æ–ª—è—Ç–æ—Ä–æ–≤), –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –∑–∞—Ö–≤–∞—Ç —Ñ–æ–Ω–∞.
* **–î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:** –í—ã–±–æ—Ä –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é (Real-time) –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é.
* **–£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** –í–µ–±-–ø–∞–Ω–µ–ª—å —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

### –û–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ –∫–ª–∞—Å—Å—ã

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç 8 —Ç–∏–ø–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤, –≤–∫–ª—é—á–∞—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã:

* üö® **–î–µ—Ñ–µ–∫—Ç—ã:**
  * `bad_insulator` ‚Äî –ü—Ä–æ–ø—É—Å–∫ –∏–∑–æ–ª—è—Ç–æ—Ä–∞ (–ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ).
  * `damaged_insulator` ‚Äî –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–π/—Å–∫–æ–ª–æ—Ç—ã–π –∏–∑–æ–ª—è—Ç–æ—Ä.
  * `nest` ‚Äî –ü—Ç–∏—á—å–∏ –≥–Ω–µ–∑–¥–∞ (—Ä–∏—Å–∫ –ø–æ–∂–∞—Ä–∞/–ö–ó).
* üèóÔ∏è **–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:**
  * `festoon_insulators` ‚Äî –°—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –≥–∏—Ä–ª—è–Ω–¥—ã.
  * `polymer_insulators` ‚Äî –ü–æ–ª–∏–º–µ—Ä–Ω—ã–µ –∏–∑–æ–ª—è—Ç–æ—Ä—ã.
  * `vibration_damper` ‚Äî –í–∏–±—Ä–æ–≥–∞—Å–∏—Ç–µ–ª–∏.
  * `traverse` ‚Äî –¢—Ä–∞–≤–µ—Ä—Å—ã.
  * `safety_sign+` ‚Äî –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—á–∫–∏.

---
![example_1](./examples/example_1.png)
![example_2](./examples/example_2.png)
![example_3](./examples/example_3.png)
![example_4](./examples/example_4.png)

---

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —É–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–µ –≤ Docker.

* **ML Core:** `Ultralytics YOLO` (OBB training pipeline).
* **Backend:** `FastAPI` (–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö).
* **Frontend:** `Streamlit` (–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π UI, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–∏–≥–æ–Ω–æ–≤, –∑—É–º).
* **Deployment:** `Docker` + `Hugging Face Spaces`.

---

## üìä ML: –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–æ–¥–µ–ª–µ–π

–í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã –±—ã–ª–∏ –æ–±—É—á–µ–Ω—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω—ã –¥–≤–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: **Small** (–¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏) –∏ **Large** (–¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω).

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**

1. **mAP50:** –¢–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ (–Ω–∞—à–ª–∞ –ª–∏ –º–æ–¥–µ–ª—å –¥–µ—Ñ–µ–∫—Ç?). *–ì–ª–∞–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞.*
2. **mAP50-95:** –ö–∞—á–µ—Å—Ç–≤–æ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ (–Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–Ω–æ —Ä–∞–º–∫–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–Ω—Ç—É—Ä–æ–º).

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

| –ö–ª–∞—Å—Å | Small **mAP50** | Large **mAP50** | **Œî mAP50** | Small mAP50-95 | Large mAP50-95 |
| :--- | :---: | :---: | :---: | :---: | :---: |
| **ALL** | 0.890 | 0.892 | +0.2% | 0.748 | 0.758 |
| `bad_insulator` üö® | **0.977** | **0.980** | +0.3% | 0.934 | 0.935 |
| `damaged_insulator` üö® | 0.920 | **0.925** | +0.5% | 0.880 | 0.892 |
| `nest` | 0.974 | 0.925 | -4.9% | 0.759 | 0.724 |
| `safety_sign+` | 0.912 | 0.913 | +0.1% | 0.718 | 0.762 |
| **`polymer_insulators`** üìâ | 0.746 | **0.772** | **+2.6%** | 0.466 | 0.489 |
| `festoon_insulators` | 0.963 | 0.970 | +0.7% | 0.854 | 0.866 |
| `vibration_damper` | 0.729 | 0.746 | **+1.7%** | 0.588 | 0.611 |
| `traverse` | 0.900 | 0.905 | +0.5% | 0.783 | 0.787 |

### üí° –ê–Ω–∞–ª–∏–∑ –∏ –í—ã–≤–æ–¥—ã

#### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å (mAP50)

–û–±–µ –º–æ–¥–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã—Ö –∫–ª–∞—Å—Å–∞—Ö:

* –ü—Ä–æ–ø—É—Å–∫–∏ –∏–∑–æ–ª—è—Ç–æ—Ä–æ–≤ (`bad_insulators`) –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é **98%**.
* –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è (`damaged_insulators`) ‚Äî —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é **92%+**.
**–í—ã–≤–æ–¥:** –†–∏—Å–∫ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å –º–∏–Ω–∏–º–∞–ª–µ–Ω. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–µ–∞–ª—å–Ω–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.

#### –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –ú–æ–¥–µ–ª—å –ë (Large)?

–ì–∏–ø–æ—Ç–µ–∑–∞ –æ —Ç–æ–º, —á—Ç–æ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –µ–º–∫–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –¥–∞—Å—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö:

* `polymer_insulators`: **+2.6%**. Large –º–æ–¥–µ–ª—å —É–≤–µ—Ä–µ–Ω–Ω–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ–Ω–∫–∏–µ –¥–ª–∏–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –≥–¥–µ –≤–∞–∂–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å —É–≥–ª–∞ –Ω–∞–∫–ª–æ–Ω–∞.
* `vibration_damper`: **+1.7%**. –ú–µ–ª–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ.

#### –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–í –≤–µ–±-—Å–µ—Ä–≤–∏—Å –≤–Ω–µ–¥—Ä–µ–Ω—ã –æ–±–µ –º–æ–¥–µ–ª–∏, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±–æ—Ä:

1. **Mode "Fast" (YOLO26s):** –û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º –∫–∞—á–µ—Å—Ç–≤–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤.
2. **Mode "Accurate" (YOLO26l):** –†–µ–∂–∏–º –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω (–ø–æ–ª–∏–º–µ—Ä–Ω—ã–µ –∏–∑–æ–ª—è—Ç–æ—Ä—ã, –ø–ª–æ—Ö–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å), –≥–¥–µ –≤–∞–∂–µ–Ω –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏.

---

## üöÄ –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è Python 3.11 –∏ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ `uv` (–∏–ª–∏ pip).

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**

   ```bash
   git clone https://github.com/–í–ê–®_USERNAME/PowerLine-Defect-Detection.git
   cd PowerLine-Defect-Detection
   ```

2. **–ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤:**
   –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã –≤–µ—Å–æ–≤ (`.pt`) –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –∏—Ö –≤ –ø–∞–ø–∫—É `weights/`.
   *–í–µ—Å–∞ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∑–∞–ø—Ä–æ—Å—É.*

3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∑–∞–ø—É—Å–∫:**
   –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∫—Ä–∏–ø—Ç `start.sh` –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ Backend –∏ Frontend.

   ```bash
   # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   pip install -r requirements.txt
   
   # –ó–∞–ø—É—Å–∫ (Linux/Mac/Git Bash)
   chmod +x start.sh
   ./start.sh
   ```

   –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

   ```bash
   # –¢–µ—Ä–º–∏–Ω–∞–ª 1
   uvicorn src.api.main:app --reload
   
   # –¢–µ—Ä–º–∏–Ω–∞–ª 2
   streamlit run src/ui/app.py
   ```

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8501`
